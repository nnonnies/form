body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; /* ใช้ฟอนต์ระบบที่ทันสมัยขึ้น */
    line-height: 1.6;
    margin: 20px;
    background-color: #f8f9fa; /* สีพื้นหลังอ่อนลง */
    color: #212529; /* สีข้อความหลัก */
}

h1, h2 {
    color: #343a40; /* สีหัวข้อเข้มขึ้น */
    text-align: center;
    margin-bottom: 25px;
}

h1 {
    font-size: 2em;
}

h2 {
    font-size: 1.5em;
    margin-top: 30px; /* เพิ่มระยะห่างด้านบนสำหรับหัวข้อรอง */
}


button {
    padding: 10px 20px; /* เพิ่ม padding ให้ปุ่มใหญ่ขึ้นเล็กน้อย */
    background-color: #0d6efd; /* เปลี่ยนสีปุ่มหลักเป็นสีน้ำเงิน */
    color: white;
    border: none;
    border-radius: 5px; /* เพิ่มความโค้งมน */
    cursor: pointer;
    margin: 5px;
    font-size: 1em;
    transition: background-color 0.2s ease-in-out; /* เพิ่ม animation */
}

button:hover {
    background-color: #0b5ed7; /* สีเข้มขึ้นเมื่อ hover */
}

/* ปุ่มหลักสำหรับสร้างฟอร์ม */
#new-survey-btn {
    display: block;
    margin: 0 auto 30px auto; /* จัดกลางและเพิ่มระยะห่างด้านล่าง */
    background-color: #198754; /* สีเขียว */
    min-width: 200px; /* กำหนดความกว้างขั้นต่ำ */
}

#new-survey-btn:hover {
    background-color: #157347;
}

/* ปุ่มยกเลิก */
#cancel-btn {
    background-color: #6c757d; /* สีเทา */
}
#cancel-btn:hover {
    background-color: #5c636a;
}

/* ปุ่มล้างข้อมูล (อันตราย) */
button.danger {
    background-color: #dc3545; /* สีแดง */
}

button.danger:hover {
    background-color: #bb2d3b;
    
}
#seeMoreRecords {
    background-color: #0b5ed7; /*ปุ่ม more*/
    padding: 10px 20px; /* เพิ่ม padding ให้ปุ่มใหญ่ขึ้นเล็กน้อย */
    color: white;
    border: none;
    border-radius: 5px; /* เพิ่มความโค้งมน */
    cursor: pointer;
    margin: 5px;
    font-size: 1em;
    transition: background-color 0.2s ease-in-out; /* เพิ่ม animation */
}
#seeLessRecords {
    background-color: #727b88; /*ปุ่ม less*/
    padding: 10px 20px; /* เพิ่ม padding ให้ปุ่มใหญ่ขึ้นเล็กน้อย */
    color: white;
    border: none;
    border-radius: 5px; /* เพิ่มความโค้งมน */
    cursor: pointer;
    margin: 5px;
    font-size: 1em;
    transition: background-color 0.2s ease-in-out; /* เพิ่ม animation */
}
.hidden {
    display: none;
}

#survey-form-container, #results-container, #summary-container {
    background-color: #ffffff;
    padding: 25px; /* เพิ่ม padding */
    margin-bottom: 25px;
    border-radius: 8px; /* เพิ่มความโค้งมน */
    box-shadow: 0 4px 8px rgba(0,0,0,0.05); /* เงาอ่อนๆ */
    border: 1px solid #dee2e6; /* เพิ่มเส้นขอบบางๆ */
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    font-size: 0.95em; /* ปรับขนาดฟอนต์ในตาราง */
}

th, td {
    border: 1px solid #dee2e6; /* สีเส้นขอบอ่อนลง */
    padding: 10px 12px; /* ปรับ padding ในเซลล์ */
    text-align: left;
    vertical-align: middle; /* จัดเนื้อหาให้อยู่กลางแนวตั้ง */
}

th {
    background-color: #e9ecef; /* สีพื้นหลังหัวตาราง */
    text-align: center;
    font-weight: 600; /* ตัวหนาขึ้นเล็กน้อย */
    white-space: nowrap; /* ไม่ให้หัวตารางตัดคำ */
}

/* จัดคอลัมน์เรตติ้งให้อยู่กลาง */
#survey-form td:not(:first-child),
#results-table td:not(:first-child) {
    text-align: center;
}

/* คอลัมน์แรก (คำถาม/ลำดับ) */
td:first-child {
    width: 40%;
}
#results-table td:first-child {
    width: auto; /* สำหรับคอลัมน์ลำดับในตารางผลลัพธ์ */
    text-align: center;
}


input[type="radio"] {
    margin: 0 5px;
    cursor: pointer;
    transform: scale(1.1); /* ขยาย radio button เล็กน้อย */
}

/* ส่วนสรุปผล */
#summary-container p {
    font-weight: 500; /* ตัวหนาเล็กน้อย */
    font-size: 1.1em;
    color: #495057;
}

#summary-details div {
    margin-bottom: 15px;
    padding: 10px;
    border-bottom: 1px solid #e9ecef; /* สีเส้นคั่น */
    background-color: #f8f9fa; /* พื้นหลังอ่อนๆ */
    border-radius: 4px;
}
#summary-details div:last-child {
    border-bottom: none;
}

#summary-details strong {
    display: block;
    margin-bottom: 8px;
    color: #343a40;
    font-weight: 600;
}

#summary-details span {
    margin-right: 15px;
    font-size: 0.95em;
    display: inline-block; /* ให้เว้นบรรทัดได้ */
    min-width: 130px; /* กำหนดความกว้างขั้นต่ำให้ดูเป็นระเบียบ */
    padding: 2px 0;
}

/* จัดตำแหน่งปุ่มล้างข้อมูล */
#results-container h2 {
    display: inline-block;
    margin-right: 15px;
    margin-bottom: 15px; /* ลดระยะห่างด้านล่างเมื่ออยู่บรรทัดเดียวกับปุ่ม */
}
#clear-all-btn {
     vertical-align: middle; /* จัดให้อยู่กลางแนวตั้งกับ h2 */
     margin-bottom: 15px;
}


/* Responsive adjustments */
@media (max-width: 992px) {
     td:first-child { width: auto; } /* ให้คำถามตัดคำได้ */
     #results-table th, #results-table td { font-size: 0.9em; padding: 8px;} /* ลดขนาดฟอนต์และ padding ในตารางผลลัพธ์ */
     #summary-details span { min-width: 110px; }
}


@media (max-width: 768px) {
    body { margin: 15px; }
    h1 { font-size: 1.8em; }
    h2 { font-size: 1.3em; }
    button { padding: 8px 15px; font-size: 0.95em;}
    #new-survey-btn { min-width: 180px;}
    th, td { padding: 8px; font-size: 0.9em; }
    #results-table th, #results-table td { font-size: 0.85em; padding: 6px;}
    #summary-details span { display: block; margin-right: 0; margin-bottom: 3px; min-width: auto;} /* ให้ span ใน summary แสดงเป็น block */
}

@media (max-width: 480px) {
     h1 { font-size: 1.5em; }
     h2 { font-size: 1.2em; }
     th, td { padding: 6px; font-size: 0.85em; }
     #survey-form td:first-child { font-weight: 500; } /* ทำให้ข้อความคำถามเข้มขึ้นเล็กน้อยบนมือถือ */
     input[type="radio"] { transform: scale(1); } /* ขนาด radio ปกติบนมือถือ */
     button { width: 100%; margin: 5px 0; } /* Stack buttons */
     #new-survey-btn, #clear-all-btn { width: auto; display: inline-block; margin: 5px; } /* ไม่ให้ปุ่มหลักกับปุ่มล้างเต็มจอ */
     #results-container h2, #clear-all-btn { display: block; width: 100%; text-align: center; margin: 10px 0; } /* จัดปุ่มล้างให้อยู่กลาง */
     #results-table { font-size: 0.8em; } /* ลดขนาดฟอนต์ตารางผลลัพธ์อีก */
}

/* --- Add Styles for Summary Table --- */
#summary-table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px; /* Add some space above the table */
    font-size: 0.9em; /* Slightly smaller font for summary */
}

#summary-table th,
#summary-table td {
    border: 1px solid #dee2e6;
    padding: 8px 10px; /* Adjust padding */
    vertical-align: middle;
}

#summary-table th {
    background-color: #e9ecef;
    text-align: center;
    font-weight: 600;
    white-space: nowrap;
}

#summary-table td:first-child { /* Question column */
    text-align: left;
    width: auto; /* Let it adjust */
    font-weight: 500;
}

#summary-table td:not(:first-child) { /* Count columns */
    text-align: center;
}

#summary-table tbody tr:nth-child(odd) { /* Zebra striping for readability */
    background-color: #f8f9fa;
}
#summary-table tbody tr:hover { /* Highlight row on hover */
    background-color: #e9ecef;
}


/* --- Style for Editable Title Focus --- */
#summary-title[contenteditable="true"] {
    cursor: text; /* Indicate it's editable */
    padding: 10px; /* Add some padding for better click area */
    border: 1px dashed transparent; /* Subtle border */
    border-radius: 4px;
    font-size: 11pt;
}

#summary-title[contenteditable="true"]:focus {
    outline: none; /* Remove default browser outline */
    border: 1px dashed #0d6efd; /* Show a border when focused */
    background-color: #eef; /* Light background when editing */
}

/* --- Hide/Show Summary Message --- */
#no-summary-message {
    text-align: center;
    color: #6c757d;
    margin-top: 20px;
    font-style: italic;
}

/* --- Style for Chart Containers (General) --- */
.chart-container {
    margin-top: 30px; /* Add space above charts */
    padding: 15px;
    border: 1px solid #e0e0e0;
    border-radius: 5px;
    background-color: #ffffff;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    /* Ensure container has some initial height/width or let canvas define it */
     /* Optional: constrain max width on screen */
}
.chart-container h3 {
    text-align: center;
    margin-bottom: 10px;
    color: #343a40;
    font-size: 1.1em;
}

#pieChartCanvas{
    width: 100%;
    height: 300px;
}
/* --- Update @media print --- */
@media print {
    body {
      /* กำหนดขนาดกระดาษและ orientation ถ้าจำเป็น (แต่ปกติ user จะเลือกเอง) */
      size: A4 portrait;
    }

    body * {
      visibility: hidden;
      margin: 0 !important; /* ใช้ !important เพื่อ override */
      padding: 0 !important;
      box-shadow: none !important;
      border: none !important;
      /* --- ลดขนาด font พื้นฐานสำหรับพิมพ์ --- */
      font-size: 9pt !important; /* ลดขนาดลงอีก ลองเริ่มที่ 9pt */
      color: black !important; /* ทำให้เป็นสีดำทั้งหมด */
    }

    #summary-container, #summary-container * {
      visibility: visible;
    }
    #summary-table, #summary-table * {
      visibility: visible;
    }

    #summary-container {
      /* position: absolute; อาจจะไม่จำเป็น ใช้ static ดีกว่า */
      position: center; /* ให้เอกสารไหลตามปกติ */
      width: 95%; /* ให้เต็มความกว้าง */
      /* --- ลด Padding รอบนอก --- */
      padding: 0.5cm !important; /* ลด padding ลง */
      margin: 0 auto !important;
      border: none !important;
      box-shadow: none !important;
      background-color: white !important;
    }

    /* ซ่อนส่วนที่ไม่ต้องการพิมพ์ */
    #new-survey-btn, #results-container, #print-summary-btn,
    #cancel-btn, #clear-all-btn, #seeMoreRecords, #seeLessRecords,
    #no-results-message, #survey-form-container {
        display: none !important;
        visibility: hidden !important;
    }

    #summary-title {
      text-align: center;
      /* --- ลด Margin และ Font Size ของหัวข้อ --- */
      margin-bottom: 10px !important;
      font-size: 11pt !important; /* ลดขนาดหัวข้อลงอีก */
      font-weight: bold;
      border: none !important;
      background-color: transparent !important;
      padding: 0 !important;
      /* --- พยายามไม่ให้หัวข้อถูกตัดไปอยู่หน้าใหม่คนเดียว --- */
      page-break-after: avoid !important;
    }

    #summary-container p,#total-forms { /* ยอดรวม */
        visibility: hidden;
        text-align: right;
        font-size: 9pt !important; /* ใช้ขนาดเดียวกับเนื้อหา */
        margin-bottom: 5px !important; /* ลด margin */
        /* --- พยายามให้อยู่กับตาราง ไม่ขึ้นหน้าใหม่คนเดียว --- */
        page-break-before: avoid !important;
    }

     /* Style for Summary Table Container on Print */
     #summary-table-container {
        page-break-before: auto; /* Default */
        page-break-after: auto;  /* Default */
        margin-bottom: 1cm; /* Add some space after the table before potential page break */
    }

    #summary-table {
      width: 100%;
      border-collapse: collapse !important;
      margin-top: 5px !important; /* ลด margin */
      /* --- ลด Font Size ของตาราง --- */
      font-size: 8pt !important; /* ลดขนาด font ในตาราง */
      border: 1px solid #666 !important;
       /* --- บอกเบราว์เซอร์ว่าอนุญาตให้ตัดหน้า *ระหว่าง* แถวได้ --- */
      page-break-inside: auto !important;
    }

    #summary-table th,
    #summary-table td {
      border: 1px solid #ccc !important;
      /* --- ลด Padding ภายในเซลล์ --- */
      padding: 3px 4px !important; /* ลด padding ลงอีก */
      text-align: center;
      background-color: white !important;
       /* --- พยายามไม่ให้ *เนื้อหาภายในเซลล์* ถูกตัดขึ้นหน้าใหม่ --- */
      page-break-inside: avoid !important;
      word-wrap: break-word; /* อนุญาตให้ตัดคำยาวๆ ในเซลล์ */
    }

     #summary-table td:first-child { /* คอลัมน์ชื่อคำถาม */
         text-align: left !important;
         /* อนุญาตให้ข้อความยาวๆ ตัดคำขึ้นบรรทัดใหม่ */
         white-space: normal !important;
     }

     #summary-table th {
        font-weight: bold;
        background-color: #eee !important;
        /* อนุญาตให้หัวตารางยาวๆ ตัดคำขึ้นบรรทัดใหม่ */
        white-space: normal !important;
     }

    /* --- พยายามให้ทั้งแถวอยู่ด้วยกัน ไม่ถูกตัดกลางแถว --- */
    #summary-table tr {
        page-break-inside: avoid !important; /* สำคัญ: พยายามไม่ตัดกลางแถว */
        page-break-after: auto !important;
    }

    .chart-container {
        display: block !important; /* Ensure visible */
        visibility: visible !important;
        width: 100% !important;
        max-width: 100% !important;
        margin-top: 1cm !important;
        padding: 0 !important;
        border: none !important;
        box-shadow: none !important;
        background-color: transparent !important;
        page-break-before: always !important; /* Force start on new page */
        page-break-inside: avoid !important; /* Keep chart content together */
    }
    .chart-container h3 {
        display: block !important; /* Ensure visible */
        visibility: visible !important;
        text-align: center !important;
        font-size: 10pt !important;
        margin-bottom: 5mm !important;
        font-weight: bold !important;
    }
     /* Ensure canvas itself is visible */
     .chart-container #pieChartCanvas{
         display: block !important;
         visibility: visible !important;
         max-width: 60%; /* Prevent exceeding container */
         height: auto !important; /* Let aspect ratio work */
         background-color: white !important; /* Ensure canvas has white background */
         margin: 0 auto !important;
         padding: 0 !important;
         border: none !important;
         box-shadow: none !important;
         page-break-inside: avoid !important;
         
     }

     .chart-container #stackedColumnChartCanvas {
        display: block !important;
        visibility: visible !important;
        max-width: 100%; /* Prevent exceeding container */
        height: auto !important; /* Let aspect ratio work */
        background-color: white !important; /* Ensure canvas has white background */
        margin: 0 auto !important;
        padding: 0 !important;
        border: none !important;
        box-shadow: none !important;
        page-break-inside: avoid !important;
        
    }
}